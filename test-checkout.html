<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Checkout - Ciclos de Cobran√ßa</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .billing-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
        }
        .billing-option {
            padding: 10px 20px;
            border: 2px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .billing-option.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        .plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .plan {
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            background: white;
        }
        .plan.popular {
            border-color: #007bff;
            background: #f8f9ff;
        }
        .price {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
            margin: 10px 0;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 15px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .logs {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .error {
            color: red;
        }
        .success {
            color: green;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste de Checkout - Ciclos de Cobran√ßa</h1>
        <p>Este √© um teste para verificar se o sistema de checkout est√° funcionando corretamente com diferentes ciclos de cobran√ßa.</p>
        
        <div class="billing-selector">
            <button class="billing-option active" data-cycle="monthly">Mensal</button>
            <button class="billing-option" data-cycle="semiannual">Semestral (-15%)</button>
            <button class="billing-option" data-cycle="annual">Anual (-25%)</button>
        </div>

        <div class="plans">
            <div class="plan">
                <h3>üöÄ Starter</h3>
                <div class="price" id="starter-price">R$ 199/m√™s</div>
                <div id="starter-subtitle">Cobran√ßa mensal</div>
                <button class="btn" onclick="testCheckout('starter')">Testar Checkout Starter</button>
            </div>
            
            <div class="plan popular">
                <h3>üíé Growth</h3>
                <div class="price" id="growth-price">R$ 249/m√™s</div>
                <div id="growth-subtitle">Cobran√ßa mensal</div>
                <button class="btn" onclick="testCheckout('growth')">Testar Checkout Growth</button>
            </div>
        </div>

        <div class="logs" id="logs">
Aguardando testes...
        </div>
    </div>

    <script>
        let currentCycle = 'monthly';
        
        const pricingConfig = {
            starter: {
                monthly: { price: 199, priceId: 'price_1RRBDsP1QgGAc8KHzueN2CJL', subtitle: 'Cobran√ßa mensal' },
                semiannual: { price: 169, priceId: 'price_1RUGkFP1QgGAc8KHAXICojLH', subtitle: 'R$ 1.014 semestrais (economia de R$ 180)' },
                annual: { price: 149, priceId: 'price_1RUGkgP1QgGAc8KHctjcrt7h', subtitle: 'R$ 1.791 anuais (economia de R$ 597)' }
            },
            growth: {
                monthly: { price: 249, priceId: 'price_1RRBEZP1QgGAc8KH71uKIH6i', subtitle: 'Cobran√ßa mensal' },
                semiannual: { price: 211, priceId: 'price_1RUAt2P1QgGAc8KHr8K4uqXG', subtitle: 'R$ 1.270 semestrais (economia de R$ 224)' },
                annual: { price: 187, priceId: 'price_1RUAtVP1QgGAc8KH01aRe0Um', subtitle: 'R$ 2.241 anuais (economia de R$ 747)' }
            }
        };

        // Event listeners para seletor de ciclo
        document.querySelectorAll('.billing-option').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.billing-option').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCycle = btn.dataset.cycle;
                updatePrices();
            });
        });

        function updatePrices() {
            document.getElementById('starter-price').textContent = `R$ ${pricingConfig.starter[currentCycle].price}/m√™s`;
            document.getElementById('starter-subtitle').textContent = pricingConfig.starter[currentCycle].subtitle;
            
            document.getElementById('growth-price').textContent = `R$ ${pricingConfig.growth[currentCycle].price}/m√™s`;
            document.getElementById('growth-subtitle').textContent = pricingConfig.growth[currentCycle].subtitle;
        }

        function log(message, type = 'info') {
            const logs = document.getElementById('logs');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'success' ? 'success' : '';
            logs.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            logs.scrollTop = logs.scrollHeight;
        }

        function testCheckout(plan) {
            const config = pricingConfig[plan][currentCycle];
            
            log(`üß™ Testando checkout para plano: ${plan}`);
            log(`üìã Ciclo: ${currentCycle}`);
            log(`üí∞ Pre√ßo: R$ ${config.price}/m√™s`);
            log(`üîó Price ID: ${config.priceId}`);
            
            // Simular chamada para a API
            const testData = {
                planId: plan,
                billingCycle: currentCycle,
                priceId: config.priceId
            };
            
            log(`üì§ Dados enviados: ${JSON.stringify(testData, null, 2)}`);
            
            // Verificar se todos os dados necess√°rios est√£o presentes
            if (!testData.planId || !testData.billingCycle || !testData.priceId) {
                log(`‚ùå Erro: Dados incompletos para o checkout`, 'error');
                return;
            }
            
            log(`‚úÖ Dados v√°lidos - Checkout seria iniciado corretamente`, 'success');
            log(`üéØ Price ID correto para ${plan} ${currentCycle}: ${config.priceId}`, 'success');
            log(`---`);
        }

        // Verificar consist√™ncia dos Price IDs
        function validatePriceIds() {
            log(`üîç Validando consist√™ncia dos Price IDs...`);
            
            const expectedIds = {
                'starter-monthly': 'price_1RRBDsP1QgGAc8KHzueN2CJL',
                'starter-semiannual': 'price_1RUGkFP1QgGAc8KHAXICojLH',
                'starter-annual': 'price_1RUGkgP1QgGAc8KHctjcrt7h',
                'growth-monthly': 'price_1RRBEZP1QgGAc8KH71uKIH6i',
                'growth-semiannual': 'price_1RUAt2P1QgGAc8KHr8K4uqXG',
                'growth-annual': 'price_1RUAtVP1QgGAc8KH01aRe0Um'
            };
            
            let allValid = true;
            
            Object.entries(expectedIds).forEach(([key, expectedId]) => {
                const [plan, cycle] = key.split('-');
                const actualId = pricingConfig[plan][cycle].priceId;
                
                if (actualId === expectedId) {
                    log(`‚úÖ ${key}: ${actualId}`, 'success');
                } else {
                    log(`‚ùå ${key}: Esperado ${expectedId}, mas encontrado ${actualId}`, 'error');
                    allValid = false;
                }
            });
            
            if (allValid) {
                log(`üéâ Todos os Price IDs est√£o corretos!`, 'success');
            } else {
                log(`‚ö†Ô∏è  Alguns Price IDs est√£o incorretos`, 'error');
            }
            log(`---`);
        }

        // Executar valida√ß√£o inicial
        validatePriceIds();
    </script>
</body>
</html>
